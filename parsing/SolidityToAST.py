from solidity_parser import parser

def solidity_to_ast(file_path):

    # print(' ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ SolidityToAST start ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ ')
    try:
        r_asts = {}
        solidity_file = open(file_path, 'r')
        solidity_code = solidity_file.read()

        ast = parser.parse(solidity_code, loc=False)
        
        # ast에서 contract만 뽑아내어
        # contract 이름을 키로 가지고 해당하는 ast를 값으로 가지는 딕셔너리를 생성
        nast = ast['children']
        for node in nast:
            if node['type'] == 'ContractDefinition':
                r_asts[node['name']] = node

        solidity_file.close()
        # print(' ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ SolidityToAST done ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ ')

        return r_asts
    except Exception as e:
        print(str(e))
